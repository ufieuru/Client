<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>도서 검색 결과</title>

  <link rel="stylesheet" href="../Css/font.css" />
  <link rel="stylesheet" href="../Css/SearchPage.css" />
  <link rel="stylesheet" href="../Css/navi.css" />

  <style>
    .back-btn {
      display: inline-block;
      margin: 10px 0 5px 8px;
      font-size: 24px;
      cursor: pointer;
      text-decoration: none;
      color: inherit;
    }
    .back-btn:hover,
    .back-btn:active {
      font-weight: 700; /* 커서/눌림 시 굵게 */
    }

    .hidden { display: none; }
    body { padding-bottom: 80px; }
  </style>
</head>
<body>
  <div class="top-bar">
    <a href="MainPage.html" class="back-btn" aria-label="뒤로가기">←</a>
    <span class="top-tittle">검색 결과</span>
  </div>

  <!-- 검색창 -->
  <header class="search-header">
    <div class="search-box">
      <input id="search-input" type="text" placeholder="도서 검색..." />
      <button id="clear-btn" class="clear-btn" type="button">✕</button>
    </div>
  </header>

  <!-- 정렬 영역 -->
  <section class="sort-section">
    <span>검색 결과 4개</span>
    <div class="sort-dropdown">
      <button id="sort-toggle" type="button">자모순 ▼</button>
      <ul id="sort-options" class="hidden"></ul>
    </div>
  </section>

  <!-- 도서 목록 -->
  <section class="book-list" id="book-list">
    <!-- 카드 1 -->
    <div class="book-card" data-popularity="60">
      <div class="book-cover">
        <img class="cover-img" src="../Images/book1.jpg" alt="문헌정보학의 이해 책 표지" />
        <div class="heart-icon-wrapper">
          <img class="heart-icon" src="../Images/blank_hearts.png" alt="좋아요 아이콘" />
        </div>
      </div>
      <div class="book-info">
        <a href="searchresult.html" class="book-title">문헌정보학의 이해</a>
        <p class="author">한국문헌정보학회</p>
        <p class="publisher">한국도서관회</p>
        <p class="code">020</p>
      </div>
      <button class="loan-btn available" type="button">대출신청</button>
    </div>

    <!-- 카드 2 -->
    <div class="book-card" data-popularity="75">
      <div class="book-cover">
        <img class="cover-img" src="../Images/book1.jpg" alt="정보자료분류론 책 표지" />
        <div class="heart-icon-wrapper">
          <img class="heart-icon" src="../Images/blank_hearts.png" alt="좋아요 아이콘" />
        </div>
      </div>
      <div class="book-info">
        <a href="searchresult.html" class="book-title">정보자료분류론</a>
        <p class="author">윤희윤</p>
        <p class="publisher">태일사</p>
        <p class="code">025.42</p>
      </div>
      <button class="loan-btn available" type="button">대출신청</button>
    </div>

    <!-- 카드 3 -->
    <div class="book-card" data-popularity="40">
      <div class="book-cover">
        <img class="cover-img" src="../Images/book2.jpg" alt="정보서비스론 책 표지" />
        <div class="heart-icon-wrapper">
          <img class="heart-icon" src="../Images/blank_hearts.png" alt="좋아요 아이콘" />
        </div>
      </div>
      <div class="book-info">
        <a href="searchresult.html" class="book-title">정보서비스론</a>
        <p class="author">박준식</p>
        <p class="publisher">계명대학교출판부</p>
        <p class="code">025.52</p>
      </div>
      <button class="loan-btn reserved" type="button">예약중</button>
    </div>

    <!-- 카드 4 -->
    <div class="book-card" data-popularity="95">
      <div class="book-cover">
        <img class="cover-img" src="../Images/book4.jpg" alt="정보자원의 기술과 메타데이터 책 표지" />
        <div class="heart-icon-wrapper">
          <img class="heart-icon" src="../Images/red_hearts.png" alt="좋아요 아이콘" />
        </div>
      </div>
      <div class="book-info">
        <a href="searchresult.html" class="book-title">정보자원의 기술과 메타데이터</a>
        <p class="author">남태우, 이승민</p>
        <p class="publisher">한국도서관협회</p>
        <p class="code">025.3</p>
      </div>
      <button class="loan-btn available" type="button">대출신청</button>
    </div>
  </section>

  <!-- 하단 내비 -->
  <footer class="bottom-nav">
    <a class="nav-item" href="loan.html">
      <img src="../Images/navigation1.png" alt="대출반납 아이콘" />
      <span>대출·반납</span>
    </a>
    <div class="nav-center">
      <a href="MainPage.html">
        <img src="../Images/navigation2.png" alt="문중문고 아이콘" class="nav-center-icon" />
      </a>
    </div>
    <a class="nav-item" href="../Pages/MyPage.Pgs/mypage.html">
      <img src="../Images/navigation3.png" alt="마이페이지 아이콘" />
      <span>마이페이지</span>
    </a>
  </footer>

  <script>
    // 정렬
    const bookList = document.getElementById('book-list');
    const sortToggle = document.getElementById('sort-toggle');
    const sortOptions = document.getElementById('sort-options');
    const OPTIONS = ['자모순', '인기도순'];

    function buildSortOptions() {
      sortOptions.innerHTML = '';
      OPTIONS.forEach(opt => {
        const li = document.createElement('li');
        li.textContent = opt;
        li.addEventListener('click', () => {
          applySort(opt);
          sortToggle.textContent = opt + ' ▼';
          sortOptions.classList.add('hidden');
        });
        sortOptions.appendChild(li);
      });
    }

    function applySort(mode) {
      const cards = Array.from(bookList.querySelectorAll('.book-card'));
      if (mode === '자모순') {
        cards.sort((a, b) => {
          const at = a.querySelector('.book-title').textContent.trim();
          const bt = b.querySelector('.book-title').textContent.trim();
          return at.localeCompare(bt, 'ko');
        });
      } else {
        cards.sort((a, b) => parseInt(b.dataset.popularity) - parseInt(a.dataset.popularity));
      }
      cards.forEach(c => bookList.appendChild(c));
    }

    sortToggle.addEventListener('click', () => {
      sortOptions.classList.toggle('hidden');
    });
    buildSortOptions();
    applySort('자모순');
    sortToggle.textContent = '자모순 ▼';

    // 대출신청 → 예약중
    bookList.addEventListener('click', e => {
      const btn = e.target.closest('.loan-btn');
      if (!btn) return;
      if (btn.classList.contains('available')) {
        btn.classList.remove('available');
        btn.classList.add('reserved');
        btn.textContent = '예약중';
      }
    });

    // 검색 지우기
    const clearBtn = document.getElementById('clear-btn');
    const searchInput = document.getElementById('search-input');
    clearBtn.addEventListener('click', () => {
      searchInput.value = '';
      searchInput.focus();
    });

    // 하트 토글
    bookList.addEventListener('click', e => {
      const heart = e.target.closest('.heart-icon');
      if (!heart) return;
      const isBlank = heart.src.includes('blank_hearts.png');
      heart.src = isBlank ? '../Images/red_hearts.png' : '../Images/blank_hearts.png';
    });
  </script>
</body>
</html>
